<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Trading Firm - Architecture Multi-Agents</title>
    <style>
        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #0f3460;
            --highlight: #e94560;
            --success: #00d9a5;
            --warning: #ffc107;
            --text: #eaeaea;
            --text-muted: #a0a0a0;
            --border: #2a2a4a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            padding: 3rem 0;
            border-bottom: 2px solid var(--border);
            margin-bottom: 3rem;
        }

        header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, var(--highlight), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        header .subtitle {
            color: var(--text-muted);
            font-size: 1.2rem;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin: 0.25rem;
        }

        .badge-success { background: var(--success); color: var(--primary); }
        .badge-warning { background: var(--warning); color: var(--primary); }
        .badge-danger { background: var(--highlight); color: white; }
        .badge-info { background: var(--accent); color: white; }

        section {
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        section h2 {
            color: var(--success);
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        section h2::before {
            content: '';
            width: 4px;
            height: 24px;
            background: var(--highlight);
            border-radius: 2px;
        }

        h3 {
            color: var(--highlight);
            margin: 1.5rem 0 1rem;
        }

        .architecture-diagram {
            background: var(--primary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85rem;
            line-height: 1.4;
            white-space: pre;
            color: var(--success);
        }

        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .agent-card {
            background: linear-gradient(145deg, var(--secondary), var(--accent));
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1.5rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(233, 69, 96, 0.2);
        }

        .agent-card.signal { border-left: 4px solid var(--success); }
        .agent-card.decision { border-left: 4px solid var(--highlight); }
        .agent-card.validation { border-left: 4px solid var(--warning); }
        .agent-card.execution { border-left: 4px solid #00bcd4; }

        .agent-card h4 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .agent-card .role {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
        }

        .agent-card ul {
            list-style: none;
            font-size: 0.9rem;
        }

        .agent-card ul li {
            padding: 0.25rem 0;
            padding-left: 1.25rem;
            position: relative;
        }

        .agent-card ul li::before {
            content: 'â†’';
            position: absolute;
            left: 0;
            color: var(--success);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border: 1px solid var(--border);
        }

        th {
            background: var(--accent);
            font-weight: 600;
            color: var(--success);
        }

        tr:nth-child(even) {
            background: rgba(255,255,255,0.02);
        }

        tr:hover {
            background: rgba(233, 69, 96, 0.1);
        }

        .flow-step {
            display: flex;
            align-items: flex-start;
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            border-left: 3px solid var(--success);
        }

        .flow-step .step-number {
            background: var(--highlight);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .flow-step .step-content h4 {
            color: var(--success);
            margin-bottom: 0.5rem;
        }

        .flow-step .step-content p {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .timeout-config {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .timeout-item {
            background: var(--secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
        }

        .timeout-item .label {
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .timeout-item .value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--warning);
        }

        .timeout-item .description {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .compliance-check {
            display: flex;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border);
        }

        .compliance-check:last-child {
            border-bottom: none;
        }

        .compliance-check .status {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            font-size: 0.8rem;
        }

        .compliance-check .status.ok {
            background: var(--success);
            color: var(--primary);
        }

        .compliance-check .rule {
            flex: 1;
        }

        .compliance-check .file {
            color: var(--text-muted);
            font-size: 0.85rem;
            font-family: monospace;
        }

        .sequence-diagram {
            background: var(--primary);
            border-radius: 8px;
            padding: 2rem;
            margin: 1rem 0;
            overflow-x: auto;
        }

        .sequence-row {
            display: flex;
            align-items: center;
            margin: 0.5rem 0;
            min-width: 800px;
        }

        .sequence-actor {
            width: 120px;
            text-align: center;
            padding: 0.5rem;
            background: var(--accent);
            border-radius: 4px;
            font-size: 0.8rem;
            flex-shrink: 0;
        }

        .sequence-arrow {
            flex: 1;
            height: 2px;
            background: var(--success);
            position: relative;
            margin: 0 1rem;
        }

        .sequence-arrow::after {
            content: 'â–¶';
            position: absolute;
            right: -8px;
            top: -8px;
            color: var(--success);
        }

        .sequence-arrow.reverse::after {
            content: 'â—€';
            left: -8px;
            right: auto;
        }

        .sequence-label {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            color: var(--text-muted);
            white-space: nowrap;
        }

        .event-type {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-family: monospace;
        }

        .event-type.market { background: #2196f3; }
        .event-type.signal { background: var(--success); color: var(--primary); }
        .event-type.decision { background: var(--highlight); }
        .event-type.validated { background: var(--warning); color: var(--primary); }
        .event-type.order { background: #9c27b0; }
        .event-type.fill { background: #00bcd4; }

        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-muted);
            border-top: 1px solid var(--border);
            margin-top: 2rem;
        }

        footer a {
            color: var(--success);
            text-decoration: none;
        }

        .toc {
            background: var(--secondary);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .toc h3 {
            margin-top: 0;
            margin-bottom: 1rem;
        }

        .toc ul {
            list-style: none;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
        }

        .toc a {
            color: var(--text);
            text-decoration: none;
            padding: 0.25rem 0;
            display: block;
            transition: color 0.2s;
        }

        .toc a:hover {
            color: var(--success);
        }

        .toc a::before {
            content: '# ';
            color: var(--highlight);
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            header h1 {
                font-size: 1.8rem;
            }

            section {
                padding: 1rem;
            }

            .architecture-diagram {
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AI Trading Firm</h1>
            <p class="subtitle">Architecture Multi-Agents - Documentation Technique</p>
            <div style="margin-top: 1rem;">
                <span class="badge badge-success">Python 3.11</span>
                <span class="badge badge-info">Interactive Brokers</span>
                <span class="badge badge-warning">Event-Driven</span>
                <span class="badge badge-danger">EU/AMF Compliant</span>
            </div>
        </header>

        <nav class="toc">
            <h3>Table des MatiÃ¨res</h3>
            <ul>
                <li><a href="#overview">Vue d'ensemble</a></li>
                <li><a href="#agents">Agents du SystÃ¨me</a></li>
                <li><a href="#dataflow">Flux de DonnÃ©es</a></li>
                <li><a href="#lifecycle">Cycle de Vie d'un Trade</a></li>
                <li><a href="#events">Ã‰vÃ©nements</a></li>
                <li><a href="#timeouts">Timeouts & Synchronisation</a></li>
                <li><a href="#compliance">ConformitÃ© CLAUDE.md</a></li>
            </ul>
        </nav>

        <!-- SECTION 1: Overview -->
        <section id="overview">
            <h2>Vue d'Ensemble de l'Architecture</h2>

            <p>Le systÃ¨me Ã©mule une sociÃ©tÃ© de trading multi-stratÃ©gies de type hedge fund.
            L'architecture respecte strictement la constitution dÃ©finie dans <code>CLAUDE.md</code>.</p>

            <div class="architecture-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AI TRADING FIRM - ARCHITECTURE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   [Interactive Brokers] â”€â”€â”€â”€ MarketDataEvent â”€â”€â”€â”€â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                                                    â”‚   EVENT BUS             â”‚  â”‚
â”‚                                                    â”‚   (Pub/Sub Async)       â”‚  â”‚
â”‚                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                â”‚                 â”‚
â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•—    â”‚
â”‚   â•‘                    SIGNAL AGENTS (ExÃ©cution ParallÃ¨le)                 â•‘    â”‚
â”‚   â•‘                                                                        â•‘    â”‚
â”‚   â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘    â”‚
â”‚   â•‘   â”‚  MACRO   â”‚  â”‚ STAT ARB â”‚  â”‚ MOMENTUM â”‚  â”‚  MARKET  â”‚  â”‚ OPTIONS  â”‚â•‘    â”‚
â”‚   â•‘   â”‚  AGENT   â”‚  â”‚  AGENT   â”‚  â”‚  AGENT   â”‚  â”‚  MAKING  â”‚  â”‚   VOL    â”‚â•‘    â”‚
â”‚   â•‘   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â•‘    â”‚
â”‚   â•šâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•    â”‚
â”‚            â”‚             â”‚             â”‚             â”‚             â”‚            â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                 â”‚ SignalEvent (fan-out)                         â”‚
â”‚                                 â–¼                                               â”‚
â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚
â”‚   â•‘              SYNCHRONIZATION BARRIER (Fan-in, timeout: 10s)             â•‘   â”‚
â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                 â”‚                                               â”‚
â”‚                                 â–¼                                               â”‚
â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚
â”‚   â•‘                      CIO AGENT (DÃ‰CIDEUR UNIQUE)                        â•‘   â”‚
â”‚   â•‘                                                                         â•‘   â”‚
â”‚   â•‘   â€¢ AgrÃ¨ge signaux avec poids    â€¢ Calcule conviction score             â•‘   â”‚
â”‚   â•‘   â€¢ SEUL Ã  crÃ©er DecisionEvent   â€¢ Log: rationale + data_sources        â•‘   â”‚
â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                 â”‚ DecisionEvent                                 â”‚
â”‚                                 â–¼                                               â”‚
â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚
â”‚   â•‘                   RISK & COMPLIANCE AGENT (SÃ©quentiel)                  â•‘   â”‚
â”‚   â•‘                                                                         â•‘   â”‚
â”‚   â•‘   Position â‰¤5% â”‚ Loss â‰¤3%/jour â”‚ Drawdown â‰¤10% â”‚ Leverage â‰¤2x â”‚ Anti-HFTâ•‘   â”‚
â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                 â”‚ ValidatedDecisionEvent                        â”‚
â”‚                                 â–¼                                               â”‚
â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚
â”‚   â•‘                    EXECUTION AGENT (SEUL Ã  trader)                      â•‘   â”‚
â”‚   â•‘                                                                         â•‘   â”‚
â”‚   â•‘   Algos: TWAP â”‚ VWAP â”‚ MARKET     Interface exclusive: Interactive Brokers  â•‘
â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                 â”‚ OrderEvent                                    â”‚
â”‚                                 â–¼                                               â”‚
â”‚                        [Interactive Brokers API]                                â”‚
â”‚                                 â”‚                                               â”‚
â”‚                                 â–¼ FillEvent                                     â”‚
â”‚                          [AUDIT LOG - EU/AMF]                                   â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>
        </section>

        <!-- SECTION 2: Agents -->
        <section id="agents">
            <h2>Agents du SystÃ¨me</h2>

            <h3>Agents de Signal (ExÃ©cution ParallÃ¨le - Fan-out)</h3>
            <div class="agents-grid">
                <div class="agent-card signal">
                    <h4>ğŸŒ Macro Agent</h4>
                    <div class="role">Signaux macro-Ã©conomiques</div>
                    <ul>
                        <li>Analyse VIX (rÃ©gime de volatilitÃ©)</li>
                        <li>Courbe des taux (yield curve)</li>
                        <li>Dollar Index (DXY)</li>
                        <li>Spreads de crÃ©dit</li>
                    </ul>
                </div>

                <div class="agent-card signal">
                    <h4>ğŸ“Š Stat Arb Agent</h4>
                    <div class="role">Arbitrage statistique</div>
                    <ul>
                        <li>Pairs trading (cointegration)</li>
                        <li>Z-score des spreads</li>
                        <li>Hedge ratio dynamique</li>
                        <li>Mean reversion</li>
                    </ul>
                </div>

                <div class="agent-card signal">
                    <h4>ğŸ“ˆ Momentum Agent</h4>
                    <div class="role">Tendances et momentum</div>
                    <ul>
                        <li>Moving Average Crossover</li>
                        <li>RSI (Relative Strength)</li>
                        <li>MACD</li>
                        <li>Rate of Change</li>
                    </ul>
                </div>

                <div class="agent-card signal">
                    <h4>ğŸ’¹ Market Making Agent</h4>
                    <div class="role">Fourniture de liquiditÃ©</div>
                    <ul>
                        <li>Fair value estimation</li>
                        <li>Spread optimal (A-S)</li>
                        <li>Gestion d'inventaire</li>
                        <li>NON-HFT (â‰¥100ms)</li>
                    </ul>
                </div>

                <div class="agent-card signal">
                    <h4>ğŸ“‰ Options Vol Agent</h4>
                    <div class="role">VolatilitÃ© et options</div>
                    <ul>
                        <li>IV Percentile ranking</li>
                        <li>Vol risk premium</li>
                        <li>Skew analysis</li>
                        <li>Term structure</li>
                    </ul>
                </div>
            </div>

            <h3>Agent de DÃ©cision (Unique)</h3>
            <div class="agents-grid">
                <div class="agent-card decision" style="grid-column: span 2;">
                    <h4>ğŸ‘” CIO Agent - Chief Investment Officer</h4>
                    <div class="role">UNIQUE AUTORITÃ‰ DE DÃ‰CISION</div>
                    <ul>
                        <li>AgrÃ¨ge tous les signaux avec pondÃ©ration configurable</li>
                        <li>Calcule le consensus directionnel (LONG/SHORT/FLAT)</li>
                        <li>Ã‰value le score de conviction (seuil: 0.6)</li>
                        <li>SEUL habilitÃ© Ã  crÃ©er des DecisionEvent</li>
                        <li>Logging obligatoire: rationale, data_sources, contributing_signals</li>
                    </ul>
                </div>
            </div>

            <h3>Agents SÃ©quentiels (Post-DÃ©cision)</h3>
            <div class="agents-grid">
                <div class="agent-card validation">
                    <h4>ğŸ›¡ï¸ Risk & Compliance Agent</h4>
                    <div class="role">Validation prÃ©-exÃ©cution</div>
                    <ul>
                        <li>Position size â‰¤ 5% portfolio</li>
                        <li>Daily loss â‰¤ 3%</li>
                        <li>Max drawdown â‰¤ 10%</li>
                        <li>Leverage â‰¤ 2x</li>
                        <li>Rate limit: 10 orders/min</li>
                        <li>Min interval: 100ms</li>
                    </ul>
                </div>

                <div class="agent-card execution">
                    <h4>âš¡ Execution Agent</h4>
                    <div class="role">SEUL Ã  envoyer des ordres</div>
                    <ul>
                        <li>Interface exclusive avec IB</li>
                        <li>Algorithmes: TWAP, VWAP, MARKET</li>
                        <li>Slicing automatique</li>
                        <li>Gestion des fills</li>
                        <li>Logging des trades</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- SECTION 3: Data Flow -->
        <section id="dataflow">
            <h2>Flux de DonnÃ©es</h2>

            <h3>Pattern Fan-out / Fan-in</h3>
            <div class="architecture-diagram">
                           INTERACTIVE BROKERS
                                   â”‚
                                   â”‚ MarketDataEvent
                                   â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                        â”‚                        â”‚
          â–¼                        â–¼                        â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Agent 1 â”‚             â”‚ Agent 2 â”‚             â”‚ Agent N â”‚
     â”‚ (async) â”‚             â”‚ (async) â”‚     ...     â”‚ (async) â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
          â”‚                        â”‚                        â”‚
          â”‚ SignalEvent            â”‚ SignalEvent            â”‚ SignalEvent
          â”‚                        â”‚                        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                      â•‘   SYNCHRONIZATION BARRIER   â•‘
                      â•‘   timeout: 10 secondes      â•‘
                      â•‘   Attend TOUS les signaux   â•‘
                      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                   â”‚
                                   â”‚ dict[agent_name â†’ SignalEvent]
                                   â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚   CIO AGENT   â”‚
                           â”‚  AgrÃ©gation   â”‚
                           â”‚  PondÃ©ration  â”‚
                           â”‚   DÃ©cision    â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ DecisionEvent
                                   â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ RISK/COMPLI.  â”‚â”€â”€â”€â–¶ REJET (si violation)
                           â”‚  Validation   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ ValidatedDecisionEvent (approved=true)
                                   â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  EXECUTION    â”‚
                           â”‚   TWAP/VWAP   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ OrderEvent
                                   â–¼
                         [Interactive Brokers]
                                   â”‚
                                   â”‚ FillEvent
                                   â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚    AUDIT LOG      â”‚
                         â”‚ decisions.jsonl   â”‚
                         â”‚ trades.jsonl      â”‚
                         â”‚ audit.jsonl       â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>
        </section>

        <!-- SECTION 4: Trade Lifecycle -->
        <section id="lifecycle">
            <h2>Cycle de Vie Complet d'un Trade</h2>

            <div class="flow-step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h4>DÃ©clenchement</h4>
                    <p><span class="event-type market">MarketDataEvent</span> reÃ§u d'Interactive Brokers.
                    Contient: symbol, bid, ask, last, volume. DistribuÃ© via EventBus Ã  tous les Signal Agents.</p>
                </div>
            </div>

            <div class="flow-step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <h4>GÃ©nÃ©ration de Signaux (ParallÃ¨le)</h4>
                    <p>Chaque Signal Agent analyse indÃ©pendamment et produit un <span class="event-type signal">SignalEvent</span>:
                    <br>â€¢ MacroAgent: VIX=14 â†’ direction=LONG, strength=0.6
                    <br>â€¢ StatArbAgent: z-score=2.3 â†’ direction=SHORT, strength=-0.8
                    <br>â€¢ MomentumAgent: MA cross bullish â†’ direction=LONG, strength=0.7</p>
                </div>
            </div>

            <div class="flow-step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <h4>Synchronisation (Barrier)</h4>
                    <p>SignalBarrier collecte tous les signaux. Timeout: 10 secondes.
                    Si timeout: CIO dÃ©cide avec les signaux disponibles (partial signals).
                    RÃ©sultat: <code>dict[agent_name â†’ SignalEvent]</code></p>
                </div>
            </div>

            <div class="flow-step">
                <div class="step-number">4</div>
                <div class="step-content">
                    <h4>DÃ©cision (CIO Agent)</h4>
                    <p>AgrÃ©gation pondÃ©rÃ©e: <code>weighted_strength = Î£(signal.strength Ã— weight[agent])</code>
                    <br>Consensus: 3 LONG vs 2 SHORT â†’ Direction = LONG
                    <br>Conviction: 0.72 > threshold(0.6) â†’ <span class="event-type decision">DecisionEvent</span> crÃ©Ã©
                    <br><strong>LOG OBLIGATOIRE:</strong> rationale, data_sources, contributing_signals</p>
                </div>
            </div>

            <div class="flow-step">
                <div class="step-number">5</div>
                <div class="step-content">
                    <h4>Validation (Risk & Compliance)</h4>
                    <p>Checks sÃ©quentiels:
                    <br>âœ“ position_limit (3% < 5%)
                    âœ“ daily_loss (-0.5% < 3%)
                    âœ“ drawdown (2% < 10%)
                    <br>âœ“ leverage (1.2x < 2x)
                    âœ“ rate_limit (5/min < 10/min)
                    âœ“ order_interval (500ms > 100ms)
                    <br>RÃ©sultat: <span class="event-type validated">ValidatedDecisionEvent</span> (approved=true/false)</p>
                </div>
            </div>

            <div class="flow-step">
                <div class="step-number">6</div>
                <div class="step-content">
                    <h4>ExÃ©cution</h4>
                    <p>Si approved=true: Execution Agent crÃ©e <span class="event-type order">OrderEvent</span>
                    <br>Algorithme TWAP: 100 shares â†’ 10 slices de 10, interval 60s
                    <br>Envoi sÃ©quentiel Ã  Interactive Brokers</p>
                </div>
            </div>

            <div class="flow-step">
                <div class="step-number">7</div>
                <div class="step-content">
                    <h4>Confirmation</h4>
                    <p><span class="event-type fill">FillEvent</span> reÃ§u d'IB
                    <br>Mise Ã  jour des positions et P&L
                    <br>LOG: symbol, side, quantity, price, commission, decision_id</p>
                </div>
            </div>

            <div class="flow-step">
                <div class="step-number">8</div>
                <div class="step-content">
                    <h4>Audit Trail (EU/AMF)</h4>
                    <p>Fichiers JSONL avec rÃ©tention 7 ans (MiFID II):
                    <br>â€¢ <code>logs/decisions.jsonl</code> - Toutes les dÃ©cisions CIO
                    <br>â€¢ <code>logs/trades.jsonl</code> - Tous les trades exÃ©cutÃ©s
                    <br>â€¢ <code>logs/audit.jsonl</code> - Tous les Ã©vÃ©nements systÃ¨me</p>
                </div>
            </div>
        </section>

        <!-- SECTION 5: Events -->
        <section id="events">
            <h2>Types d'Ã‰vÃ©nements</h2>

            <table>
                <thead>
                    <tr>
                        <th>Ã‰vÃ©nement</th>
                        <th>Source</th>
                        <th>DÃ©clenche</th>
                        <th>Consommateurs</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="event-type market">MarketDataEvent</span></td>
                        <td>IB Broker</td>
                        <td>Analyse de signal</td>
                        <td>Tous les Signal Agents</td>
                    </tr>
                    <tr>
                        <td><span class="event-type signal">SignalEvent</span></td>
                        <td>Signal Agents</td>
                        <td>AgrÃ©gation CIO</td>
                        <td>CIO Agent (via Barrier)</td>
                    </tr>
                    <tr>
                        <td><span class="event-type decision">DecisionEvent</span></td>
                        <td>CIO Agent</td>
                        <td>Validation</td>
                        <td>Risk/Compliance Agent</td>
                    </tr>
                    <tr>
                        <td><span class="event-type validated">ValidatedDecisionEvent</span></td>
                        <td>Risk Agent</td>
                        <td>ExÃ©cution</td>
                        <td>Execution Agent</td>
                    </tr>
                    <tr>
                        <td><span class="event-type order">OrderEvent</span></td>
                        <td>Execution Agent</td>
                        <td>Ordre IB</td>
                        <td>Broker IB</td>
                    </tr>
                    <tr>
                        <td><span class="event-type fill">FillEvent</span></td>
                        <td>Broker IB</td>
                        <td>Update + Log</td>
                        <td>Audit Logger</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-danger">RiskAlertEvent</span></td>
                        <td>Risk Agent</td>
                        <td>HALT (si critical)</td>
                        <td>Orchestrator</td>
                    </tr>
                </tbody>
            </table>

            <p style="margin-top: 1rem; color: var(--text-muted);">
                <strong>Important:</strong> Le systÃ¨me est 100% event-driven. Pas de polling, pas de boucles infinies.
                Chaque action est dÃ©clenchÃ©e par un Ã©vÃ©nement.
            </p>
        </section>

        <!-- SECTION 6: Timeouts -->
        <section id="timeouts">
            <h2>Timeouts & Synchronisation</h2>

            <div class="timeout-config">
                <div class="timeout-item">
                    <div class="label">Signal Timeout</div>
                    <div class="value">5s</div>
                    <div class="description">Temps max pour qu'un agent produise un signal</div>
                </div>
                <div class="timeout-item">
                    <div class="label">Barrier Timeout</div>
                    <div class="value">10s</div>
                    <div class="description">Temps max d'attente pour tous les signaux</div>
                </div>
                <div class="timeout-item">
                    <div class="label">Agent Processing</div>
                    <div class="value">30s</div>
                    <div class="description">Timeout par traitement d'Ã©vÃ©nement</div>
                </div>
                <div class="timeout-item">
                    <div class="label">Broker Connection</div>
                    <div class="value">30s</div>
                    <div class="description">Timeout connexion Interactive Brokers</div>
                </div>
            </div>

            <h3>Rate Limiting (Anti-HFT)</h3>
            <div class="timeout-config">
                <div class="timeout-item">
                    <div class="label">Max Orders/Minute</div>
                    <div class="value">10</div>
                    <div class="description">Limite d'ordres par minute</div>
                </div>
                <div class="timeout-item">
                    <div class="label">Min Order Interval</div>
                    <div class="value">100ms</div>
                    <div class="description">Intervalle minimum entre ordres</div>
                </div>
                <div class="timeout-item">
                    <div class="label">Quote Refresh (MM)</div>
                    <div class="value">1000ms</div>
                    <div class="description">RafraÃ®chissement quotes Market Making</div>
                </div>
                <div class="timeout-item">
                    <div class="label">TWAP Slice Interval</div>
                    <div class="value">60s</div>
                    <div class="description">Intervalle entre slices TWAP</div>
                </div>
            </div>
        </section>

        <!-- SECTION 7: Compliance -->
        <section id="compliance">
            <h2>ConformitÃ© CLAUDE.md</h2>

            <p style="margin-bottom: 1.5rem;">VÃ©rification de la conformitÃ© de l'implÃ©mentation avec la constitution:</p>

            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Architecture multi-agents stricte (8 agents distincts)</div>
                <div class="file">agents/</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">ResponsabilitÃ© unique par agent</div>
                <div class="file">core/agent_base.py</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">CIO = unique dÃ©cideur (seul crÃ©e DecisionEvent)</div>
                <div class="file">agents/cio_agent.py:185</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Fan-out: signaux en parallÃ¨le (asyncio)</div>
                <div class="file">core/agent_base.py:95</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Fan-in: barriÃ¨re de synchronisation avec timeout</div>
                <div class="file">core/event_bus.py:25-58</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">SÃ©quentiel post-dÃ©cision (Risk â†’ Execution)</div>
                <div class="file">main.py:280-290</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Event-driven, pas de polling</div>
                <div class="file">core/event_bus.py</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Timeouts obligatoires configurÃ©s</div>
                <div class="file">config.yaml:15-20</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Anti-HFT (rate limit + min interval)</div>
                <div class="file">agents/risk_compliance_agent.py:180</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Paper trading par dÃ©faut</div>
                <div class="file">config.yaml:5,12</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Audit logging EU/AMF (JSONL, 7 ans)</div>
                <div class="file">core/logger.py</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Pas de HFT (Market Making â‰¥ 100ms)</div>
                <div class="file">agents/market_making_agent.py:52</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Pas de stratÃ©gies auto-modifiantes</div>
                <div class="file">strategies/*.py (stateless)</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">Pas de scaling autonome du capital</div>
                <div class="file">agents/cio_agent.py (fixed sizing)</div>
            </div>
            <div class="compliance-check">
                <div class="status ok">âœ“</div>
                <div class="rule">SystÃ¨me testable, observable, auditable</div>
                <div class="file">tests/, logs/</div>
            </div>

            <div style="margin-top: 2rem; padding: 1rem; background: rgba(0,217,165,0.1); border-radius: 8px; border-left: 4px solid var(--success);">
                <strong style="color: var(--success);">âœ“ CONFORMITÃ‰ 100%</strong>
                <p style="margin-top: 0.5rem; color: var(--text-muted);">
                    L'architecture implÃ©mentÃ©e respecte strictement toutes les rÃ¨gles dÃ©finies dans CLAUDE.md.
                </p>
            </div>
        </section>

        <footer>
            <p>AI Trading Firm - Architecture Documentation</p>
            <p>GÃ©nÃ©rÃ© automatiquement | <a href="claude.md">Voir CLAUDE.md</a> | Python 3.11 | Interactive Brokers</p>
            <p style="margin-top: 1rem; font-size: 0.8rem;">
                âš ï¸ Paper Trading par dÃ©faut | ConformitÃ© EU/AMF | Pas de HFT
            </p>
        </footer>
    </div>
</body>
</html>
